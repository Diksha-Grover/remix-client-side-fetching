import{a as C}from"/build/_shared/chunk-S6ED77EY.js";import{a as A}from"/build/_shared/chunk-C7XIK5V6.js";import"/build/_shared/chunk-URNZPFSF.js";import{a as u,b as F}from"/build/_shared/chunk-O7DBANPF.js";import{a as l,b as L,d as m}from"/build/_shared/chunk-A7IPQTS3.js";import{c as g,e as N,h as y,j as f,q as v,t as h}from"/build/_shared/chunk-KV7DDRWL.js";import{a as T}from"/build/_shared/chunk-FPOB764B.js";import{a as I,b as w}from"/build/_shared/chunk-XBDI323W.js";import{c as r}from"/build/_shared/chunk-Q3IECNXJ.js";var S=r(A()),q=r(T());var k=r(C());var c=r(I()),e=r(w());function B(i){return i<=0?"Must be greater than 0":Number(i.toFixed(2))!==i?"Must only have two decimal places":null}function M(i){return Number.isNaN(i.getTime())?"Please enter a valid date":null}var D="flex justify-between border-t border-gray-100 py-4 text-[14px] leading-[24px]";function E(){let i=v(),o=g();return(0,e.jsxs)("div",{className:"relative p-10",children:[(0,e.jsx)(f,{to:`../../customers/${i.customerId}`,className:"text-[length:14px] font-bold leading-6 text-blue-600 underline",children:i.customerName}),(0,e.jsx)("div",{className:"text-[length:32px] font-bold leading-[40px]",children:u.format(i.totalAmount)}),(0,e.jsxs)(m,{children:[(0,e.jsx)("span",{className:i.dueStatus==="paid"?"text-green-brand":i.dueStatus==="overdue"?"text-red-brand":"",children:i.dueDisplay}),` \u2022 Invoiced ${i.invoiceDateDisplay}`]}),(0,e.jsx)("div",{className:"h-4"}),i.lineItems.map(n=>(0,e.jsx)(R,{description:n.description,unitPrice:n.unitPrice,quantity:n.quantity},n.id)),(0,e.jsxs)("div",{className:`${D} font-bold`,children:[(0,e.jsx)("div",{children:"Net Total"}),(0,e.jsx)("div",{children:u.format(i.totalAmount)})]}),(0,e.jsx)("div",{className:"h-8"}),(0,e.jsx)(P,{})]},o.key)}function P(){var x;let i=v(),o=h(),n=(0,c.useRef)(null),p=[...i.deposits];if(o.submission){let a=Number(o.submission.formData.get("amount")),d=o.submission.formData.get("depositDate"),s=typeof d=="string"?F(d):null;!B(a)&&s&&!M(s)&&p.push({id:"new",amount:a,depositDateFormatted:s.toLocaleDateString()})}let t=(x=o.data)==null?void 0:x.errors;return(0,c.useEffect)(()=>{var d,s,b;if(!n.current||o.state!=="idle")return;let a=n.current;t!=null&&t.amount?(d=a.elements.amount)==null||d.focus():t!=null&&t.depositDate?(s=a.elements.depositDate)==null||s.focus():document.activeElement===a.elements.intent&&(a.reset(),(b=a.elements.amount)==null||b.focus())},[o.state,t]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"font-bold leading-8",children:"Deposits"}),p.length>0?p.map(a=>(0,e.jsxs)("div",{className:D,children:[(0,e.jsx)(f,{to:`../../deposits/${a.id}`,className:"text-blue-600 underline",children:a.depositDateFormatted}),(0,e.jsx)("div",{children:u.format(a.amount)})]},a.id)):(0,e.jsx)("div",{children:"None yet"}),(0,e.jsxs)(o.Form,{method:"post",className:"grid grid-cols-1 gap-x-4 gap-y-2 lg:grid-cols-2",ref:n,noValidate:!0,children:[(0,e.jsxs)("div",{className:"min-w-[100px]",children:[(0,e.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[(0,e.jsx)(m,{children:(0,e.jsx)("label",{htmlFor:"depositAmount",children:"Amount"})}),t!=null&&t.amount?(0,e.jsx)("em",{id:"amount-error",className:"text-d-p-xs text-red-600",children:t.amount}):null]}),(0,e.jsx)("input",{id:"depositAmount",name:"amount",type:"number",className:l,min:"0.01",step:"any",required:!0,"aria-invalid":Boolean(t==null?void 0:t.amount)||void 0,"aria-errormessage":t!=null&&t.amount?"amount-error":void 0})]}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[(0,e.jsx)(m,{children:(0,e.jsx)("label",{htmlFor:"depositDate",children:"Date"})}),t!=null&&t.depositDate?(0,e.jsx)("em",{id:"depositDate-error",className:"text-d-p-xs text-red-600",children:t.depositDate}):null]}),(0,e.jsx)("input",{id:"depositDate",name:"depositDate",type:"date",className:`${l} h-[34px]`,required:!0,"aria-invalid":Boolean(t==null?void 0:t.depositDate)||void 0,"aria-errormessage":t!=null&&t.depositDate?"depositDate-error":void 0})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 gap-4 lg:col-span-2 lg:flex",children:[(0,e.jsxs)("div",{className:"flex-1",children:[(0,e.jsx)(m,{children:(0,e.jsx)("label",{htmlFor:"depositNote",children:"Note"})}),(0,e.jsx)("input",{id:"depositNote",name:"note",type:"text",className:l})]}),(0,e.jsx)("div",{className:"flex items-end",children:(0,e.jsx)("button",{type:"submit",className:L,name:"intent",value:"create-deposit",children:"Create"})})]})]})]})}function R({description:i,quantity:o,unitPrice:n}){return(0,e.jsxs)("div",{className:D,children:[(0,e.jsx)("div",{children:i}),o===1?null:(0,e.jsxs)("div",{className:"text-[10px]",children:["(",o,"x)"]}),(0,e.jsx)("div",{children:u.format(n)})]})}function $(){let i=y(),o=N();if(i.status===404)return(0,e.jsxs)("div",{className:"p-12 text-red-500",children:['No invoice found with the ID of "',o.invoiceId,'"']});throw new Error(`Unexpected caught response with status: ${i.status}`)}function H({error:i}){return console.error(i),(0,e.jsx)("div",{className:"absolute inset-0 flex justify-center bg-red-100 pt-4",children:(0,e.jsxs)("div",{className:"text-red-brand text-center",children:[(0,e.jsx)("div",{className:"text-[14px] font-bold",children:"Oh snap!"}),(0,e.jsx)("div",{className:"px-2 text-[12px]",children:"There was a problem. Sorry."})]})})}export{$ as CatchBoundary,H as ErrorBoundary,E as default};
